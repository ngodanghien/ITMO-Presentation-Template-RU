% --------------------------------------------------------------------------
% Version 2.1
% This template is available on the sites:
% https://www.overleaf.com/read/rpkkfchcnbsc
% https://www.overleaf.com/latex/templates/itmo-beamer-theme/fpttrgnmqwsb
% https://github.com/AlexZabashta/ITMO-Beamer-theme
% ref: https://latex-beamer.com/tutorials/environments/
% --------------------------------------------------------------------------

\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
%\usepackage[T2A]{fontenc}
\usepackage[T1,T2A]{fontenc}
\usepackage{float}
\usepackage{amsmath,amssymb}
\usepackage{bm} %package bm (which stands for “bold math”) and use the \bm command
\usepackage{array} %use {tabular}{||m{4cm}|m{2cm}||}
\usepackage{xcolor}
\usepackage{tikz}
\usepackage{hyperref}
%\hypersetup{
%		unicode=true,
%		colorlinks=true, % to remove []
%		linkcolor = ITMOred,
%		citecolor = ITMOgreen,
%		urlcolor = ITMOblue,
%}
%\usepackage{cleveref}
%\usepackage{cmap}
\usepackage{ulem} % six more different ways to decorate text: \uline{}, \uuline{} ...
% provides the \justifying command
\usepackage{ragged2e}

%===================================\\
% Это нужно, чтобы он называл рисунки без сокращения "рис.".
% Таблицы он называет без сокращения по умолчанию.
\addto\captionsrussian{\renewcommand{\figurename}{Рисунок}}
% Пакет для использования запятой в качестве десятичного разделителя.
% Следите, чтобы в формулах запятые стояли с пробелами, там где они запятые. Например $v = (x, y, z)$
\usepackage{icomma}
%====================
%https://tex.stackexchange.com/questions/127145/beamer-presentation-figure-has-no-number
\setbeamertemplate{caption}[numbered] %To achieve numbering of figures
\setbeamertemplate{theorems}[numbered]
%==================
\usetheme{Madrid} %ok
%https://deic.uab.cat/~iblanes/beamer_gallery/individual/Madrid-default-default.html
\usecolortheme{default}
%======================
\definecolor{ITMOblue}{RGB}{25,70,186} 
\definecolor{ITMOred}{RGB}{236,11,67} 
\definecolor{ITMOwhite}{RGB}{255,255,255} 

\definecolor{ITMOorange}{RGB}{255,132,0}
\definecolor{ITMOsky}{RGB}{57,180,230}
\definecolor{ITMOpistachio}{RGB}{150,214,0}
\definecolor{ITMOaqua}{RGB}{34,172,155}
\definecolor{ITMOice}{RGB}{91,193,214}
\definecolor{ITMOgold}{RGB}{255,222,23} 
\definecolor{ITMOyellow}{RGB}{235,231,14} 
\definecolor{ITMOtomato}{RGB}{234,65,38}
\definecolor{ITMOgreen}{RGB}{0,148,77} 


\setbeamercolor{title}{fg=ITMOwhite}
\setbeamercolor{frametitle}{fg=ITMOwhite,bg=ITMOblue}

\setbeamercolor{alerted text}{fg=ITMOtomato}

%\setbeamercolor{block title alerted}{fg=ITMOtomato}
%\setbeamercolor{block title}{fg=ITMOblue}
%\setbeamercolor{block title example}{fg=ITMOgreen}

\setbeamercolor{caption name}{fg=ITMOblue}
\setbeamercolor{footline}{fg=ITMOwhite,bg=ITMOblue}
\setbeamercolor{headline}{fg=ITMOwhite,bg=ITMOblue}

%\setbeamertemplate{itemize item}[circle]
%\setbeamertemplate{itemize subitem}[circle]
%\setbeamertemplate{itemize subsubitem}[circle]
%\setbeamercolor{itemize item}{fg=ITMOred}
%\setbeamercolor{itemize subitem}{fg=ITMOred}
%\setbeamercolor{itemize subsubitem}{fg=ITMOred}
%\setbeamercolor{enumerate item}{fg=ITMOred}
%\setbeamercolor{enumerate subitem}{fg=ITMOred}
%\setbeamercolor{enumerate subsubitem}{fg=ITMOred}
%\setbeamercolor{item projected}{fg=ITMOred}



\newcommand{\itmopolygons}[1]{
\tikz[remember picture,overlay] \node at (current page.center){
	\includegraphics[height=\paperheight,width=\paperwidth]{itmo/polygons.pdf}
};
\tikz \node at (current page.center){
	\begin{minipage}[t][0.97\paperheight][c]{0.843\paperwidth}
		\begin{center}
			\usebeamercolor[fg]{title}{
				#1
			}
		\end{center}
	\end{minipage}
};
}


\setbeamertemplate{title page}{
	\itmopolygons{
	    \begin{center}
	        \vfill
    		\usebeamerfont{titlegraphic}{\inserttitlegraphic}
    		\vfill
    		\usebeamerfont{title}{  \inserttitle} 
    		\vfill
    		\usebeamerfont{subtitle}{\insertsubtitle}
    		\vfill
    		\insertauthor
    		\vfill
    		\insertinstitute
    		\vfill
    		\ifx\insertplace\empty
    			\insertdate
    		\else
    			\insertplace,  \insertdate
    		\fi
		\end{center}
	}
}


\def \insertplace {}
\newcommand{\where}[1]{ \def \insertplace {#1} }


%\def \insertfootlinetext {\inserttitle}
%\def \insertfootlinetext {\insertsection} 
\def \insertfootlinetext {\textcolor{black}{\insertsection}} 

\newcommand{\setfootlinetext}[1]{ \def \insertfootlinetext {#1} }


\setbeamertemplate{navigation symbols}{}
%\setbeamertemplate{footline}[page number]{}
\setbeamerfont{footnote}{size=\scriptsize}

%\setbeamertemplate{footline}{
%	\colorbox{ITMOblue}{\begin{minipage}[c][0.04\textheight][c]{0.85\paperwidth}\hskip1em\insertfootlinetext\hfill\end{minipage}}\colorbox{ITMOred}{\begin{minipage}[c][0.04\textheight][c]{0.15\paperwidth}\begin{center}\textbf{\insertframenumber/\inserttotalframenumber}\end{center}\end{minipage}}}

\def\inserthome{\hyperlink{toc}{Оглавление}}
\def\inserthome{\hyperlink{tableslide}{Слайды}}
\setlength{\fboxrule}{0.5mm} % Set border thickness (outside border)
\setlength{\fboxsep}{3pt} % Padding between the content and the border
\setbeamertemplate{footline}{
		\fcolorbox{ITMOblue}{ITMOwhite}{\begin{minipage}[c][0.0285\textheight][c]{0.08\paperwidth}\hskip0.5em\inserthome\hfill\end{minipage}}\colorbox{ITMOblue}{\begin{minipage}[c][0.04\textheight][c]{0.8\paperwidth}\begin{center}\insertfootlinetext\end{center}\end{minipage}}\colorbox{ITMOred}{\begin{minipage}[c][0.04\textheight][c]{0.08\paperwidth}\begin{center}\textbf{\insertframenumber/\inserttotalframenumber}\end{center}\end{minipage}}}
%

\setbeamerfont{footline}{size=\footnotesize}
\setbeamerfont{frametitle}{size=\bf\large}%{size=\bf\Large}


\setbeamertemplate{frametitle}{
	\nointerlineskip
	\begin{beamercolorbox}[wd=\paperwidth,ht=2.3ex,dp=0.9ex]{frametitle}
			\hspace{1ex}
			\insertframetitle	\hfill
			\includegraphics[height=0.4cm]{itmo/logo-basic-russian-white.pdf}
			\hspace{0.5ex}
		\end{beamercolorbox}
}
%\beamercolorbox tạo ra một hộp với màu sắc và các thiết lập khác liên quan đến Beamer. Các tùy chọn được sử dụng ở đây:
%\nointerlineskip:
%Lệnh này ngăn cách dòng mới được thêm vào sau tiêu đề, đảm bảo rằng không có khoảng cách không mong muốn giữa tiêu đề và nội dung kế tiếp.
%[wd=\paperwidth]: Chiều rộng của hộp bằng chiều rộng của trang (\paperwidth).
%[ht=2.3ex]: Chiều cao của hộp là 2.3 đơn vị "ex" (x-height, chiều cao của chữ "x" trong phông chữ hiện tại).
%[dp=0.9ex]: Độ sâu của hộp (distance from baseline) là 0.9 đơn vị "ex".
%{frametitle}: Chỉ ra rằng hộp này áp dụng màu sắc và các thiết lập khác được định nghĩa cho phần tiêu đề khung (frametitle).